#!/usr/bin/env python3

import pathlib
import subprocess
import shutil

def main():
    ruff = shutil.which('ruff')
    if not ruff:
        raise SystemExit('ERROR: ruff command not available')

    reporoot = pathlib.Path(__file__).parent.parent
    pyfiles = []
    pyfiles += list( reporoot.joinpath('bin').rglob('*.py') )
    pyfiles += list( reporoot.joinpath('src').rglob('*.py') )
    rv = subprocess.run(['ruff','check']
                        + sorted( f.absolute() for f in pyfiles ) )
    if rv.returncode!=0:
        raise SystemExit(1)

if __name__=='__main__':
    main()
