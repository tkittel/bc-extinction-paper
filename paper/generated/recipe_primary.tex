\begin{algorithm}
    \caption{Algorithm for calculating $y_P(x,\sin\theta)$.
             When $x\le1000$ the result has an absolute error less than $10^{-3}\cdot\min(y_\text{true},1-y_\text{true})$.
             All variables must be double precision floating point types or better, as per the \texttt{binary64} format\protect\cite{IEEE754}.}
    \begin{algorithmic}[1]
        \small
        \Procedure{YP}{$x, \sin\theta$}
            \If{$x < 0.1$}
                \State ${y_0} \gets 1-{x}{\cdot}(0.94285714-{x}{\cdot}(0.8204-{x}{\cdot}(0.593-{x}{\cdot}(0.364-0.19{\cdot}{x}))))$
            \Else
                \If{$x>1000$}
                    \State \textbf{return} $\text{YP}(1000,\sin\theta)\cdot\sqrt{1000/x}$
                \EndIf
                \State $x_s \gets \sqrt{x} $
                \State $x' \gets (x_s-1)/(x_s+1) $
                \State ${y_0} \gets 0.518212-{x'}{\cdot}(0.93036-{x'}{\cdot}(0.182006+{x'}{\cdot}(1.10097-{x'}{\cdot}(0.62625$\\
                  \hspace{6em}$+{x'}{\cdot}(1.73562-{x'}{\cdot}(1.08506+{x'}{\cdot}(2.19459-{x'}{\cdot}(1.40451+{x'}{\cdot}(1.62083$\\
                  \hspace{6em}$-{x'}{\cdot}(1.1031+{x'}{\cdot}(0.49125-0.357611{\cdot}{x'})))))))))))$
            \EndIf
                \State $s \gets \sqrt{\sin\theta} $
                \State $u \gets x{\cdot}s$
            \If{$u < 0.1$}
                \State ${y^\Delta} \gets {u}{\cdot}{u}{\cdot}(0.41021645-{u}{\cdot}(1.187-{u}{\cdot}(2.37-4.18{\cdot}{u}))))$
            \Else
                \State $u_s \gets \sqrt{u} $
                \State $u' \gets (u_s-1)/(u_s+1) $
                \State ${y^\Delta} \gets 0.05508+{u'}{\cdot}(0.1166-{u'}{\cdot}(0.2099+{u'}{\cdot}(0.5482-{u'}{\cdot}(0.5248+{u'}{\cdot}(1.402$\\
                  \hspace{6em}$-{u'}{\cdot}(1.168+{u'}{\cdot}(2.096-{u'}{\cdot}(2.116+{u'}{\cdot}(1.155-{u'}{\cdot}(1.952$\\
                  \hspace{6em}$-0.6046{\cdot}{u'}))))))))))$
            \EndIf
            \State \textbf{return} $y_0 + \sin\theta{\cdot}s{\cdot}y^\Delta$
        \EndProcedure
    \end{algorithmic}
    \label{alg:yfct_primary}
\end{algorithm}
