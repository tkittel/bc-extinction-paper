
################################################################################
################################################################################
###                         BC2025 Standard Recipes                          ###
###     Precision guarantee for x<1000: Error less than 1e-3*min(y,1-y)      ###
###        Reference: T. Kittelmann 2025 (publication in preparation)        ###
################################################################################
################################################################################

def bc2025_y_primary( x, sintheta ):
    if x < 0.1:
        y0 = 1.0-x*(0.94285714-x*(0.8204-x*(0.593-x*(0.364-0.19*x))))
    else:
        if x > 1e3:
            return bc2025_y_primary(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.518212-xp*(0.93036-xp*(0.182006+xp*(1.10097-xp*(0.62625
               +xp*(1.73562-xp*(1.08506+xp*(2.19459-xp*(1.40451+xp*(1.62083
               -xp*(1.1031+xp*(0.49125-0.357611*xp))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.1:
        ydelta = u*u*(0.41021645-u*(1.187-u*(2.37-4.18*u)))
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.05508+up*(0.1166-up*(0.2099+up*(0.5482-up*(0.5248+up*(1.402
                   -up*(1.168+up*(2.096-up*(2.116+up*(1.155-up*(1.952
                   -0.6046*up)))))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndgauss( x, sintheta ):
    if x < 0.1:
        y0 = 1.0-x*(1.0606602-x*(0.9238-x*(0.667-x*(0.409-0.22*x))))
    else:
        if x > 1e3:
            return bc2025_y_scndgauss(1e3,sintheta)*(x*1e-3)**-0.933
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.4588909-xp*(1.038687-xp*(0.2401003+xp*(1.288282-xp*(0.7641972
               +xp*(1.880246-xp*(1.886916+xp*(2.171852-xp*(3.273034
               +xp*(0.9771599-xp*(2.988445-xp*(0.4993548+xp*(1.037121
               -0.4353142*xp)))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.1:
        ydelta = u*u*(0.46188022-u*(1.333-u*(2.66-4.68*u)))
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.062289443+up*(0.13177896-up*(0.240705+up*(0.61857545
                   -up*(0.61744404+up*(1.4812474-up*(1.5419561+up*(1.9976424
                   -up*(2.8090858+up*(0.74297172-up*(2.3120683
                   -0.8661981*up)))))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndlorentz( x, sintheta ):
    if x < 0.1:
        y0 = 1.0-x*(1.0-x*(1.0667-x*(0.988-x*(0.79-0.55*x))))
    else:
        if x > 1e3:
            return bc2025_y_scndlorentz(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.53379-xp*(0.84182-xp*(0.16806+xp*(0.65124-xp*(0.67623
               +xp*(0.47199-xp*(1.0872+xp*(0.030142-xp*(0.91361-xp*(0.28313
               +xp*(0.30078-0.1507*xp)))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.1:
        ydelta = u*u*(0.53333333-u*(1.9753-u*(5.14-11.9*u)))
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.0514714+up*(0.0863117-up*(0.191581+up*(0.266342
                   -up*(0.504516+up*(0.32195-up*(0.894662-up*(0.0162501
                   +up*(0.708855-0.33707*up)))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndfresnel( x, sintheta ):
    if x < 0.1:
        y0 = 1.0-x*(1.0-x*(0.88-x*(0.639-x*(0.394-0.21*x))))
    else:
        if x > 1e3:
            return bc2025_y_scndfresnel(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.493354-xp*(0.963692-xp*(0.235067+xp*(1.18222-xp*(0.672931
               +xp*(1.78522-xp*(1.09976+xp*(2.10882-xp*(1.34721+xp*(1.46841
               -xp*(1.0054+xp*(0.426279-0.313436*xp))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.1:
        ydelta = u*u*(0.44-u*(1.278-u*(2.56-4.52*u)))
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.05839+up*(0.12063-up*(0.233343+up*(0.578753-up*(0.584531
                   +up*(1.42753-up*(1.28278+up*(1.95436-up*(2.18561+up*(0.877761
                   -up*(1.80505-0.599956*up)))))))))) )
    return y0 + sintheta*s*ydelta


################################################################################
################################################################################
###                          BC2025 Luxury Recipes                           ###
###     Precision guarantee for x<1000: Error less than 1e-6*min(y,1-y)      ###
###        Reference: T. Kittelmann 2025 (publication in preparation)        ###
################################################################################
################################################################################

def bc2025_y_primary_lux( x, sintheta ):
    if x < 0.02:
        y0 = ( 1.0-x*(0.94285714285714-x*(0.8204329004329-x*(0.59332136724729
               -x*(0.36445371604802-0.19428532960037*x)))) )
    else:
        if x > 1e3:
            return bc2025_y_primary_lux(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.5181739142759-xp*(0.9312354258708-xp*(0.1838441456426
               +xp*(1.1362742358-xp*(0.6439499617823+xp*(2.206331176315
               -xp*(1.140630599466+xp*(5.318659095481-xp*(1.818212320215
               +xp*(14.55391219715-xp*(10.87410353778+xp*(45.03938805729
               -xp*(110.6857924368+xp*(174.6473769273-xp*(720.5710673832
               +xp*(736.1717109119-xp*(3106.364394659+xp*(2617.91188764
               -xp*(9418.786974417+xp*(6988.557590101-xp*(20670.35083956
               +xp*(13504.21392907-xp*(33107.13743136+xp*(18520.07264798
               -xp*(38415.15440831+xp*(17532.51527802-xp*(31492.96870494
               +xp*(10877.45934053-xp*(17311.15064191+xp*(3975.170684325
               -xp*(5724.961892345+xp*(647.8950238727
               -860.4745834869*xp))))))))))))))))))))))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.02:
        ydelta = ( u*u*(0.41021645021645-u*(1.1866427344946-u*(2.3689491543122
                   -4.1771345864079*u))) )
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.05508580666571+up*(0.1171543796275-up*(0.2094959893224
                   +up*(0.5753610003144-up*(0.5029926535087+up*(1.827528591995
                   -up*(0.9343233427577+up*(5.560154682465-up*(1.67846357379
                   +up*(21.02643609634-up*(13.57802643233+up*(107.3363063748
                   -up*(151.8892352219+up*(576.5632688968-up*(1071.234226007
                   +up*(2533.754063934-up*(5066.801335663+up*(8223.815227808
                   -up*(16955.1507836+up*(18939.97089727-up*(40926.64492568
                   +up*(29716.04901001-up*(71039.43814205+up*(29047.97910648
                   -up*(86612.37915478+up*(12774.94362795-up*(70438.23189688
                   -up*(4826.668786858+up*(34308.55921383-up*(8466.342245127
                   +up*(7568.031380324
                   -2978.804894556*up)))))))))))))))))))))))))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndgauss_lux( x, sintheta ):
    if x < 0.02:
        y0 = ( 1.0-x*(1.0606601717798-x*(0.9237604307034-x*(0.66666666666667
               -x*(0.40888100159996-0.21773242158073*x)))) )
    else:
        if x > 1e3:
            return bc2025_y_scndgauss_lux(1e3,sintheta)*(x*1e-3)**-0.933
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.45898433395-xp*(1.0398885672-xp*(0.23347432787+xp*(1.3320564936
               -xp*(0.65964335645+xp*(2.4573554347-xp*(1.1858452452
               +xp*(6.0101020414-xp*(0.42409952962+xp*(16.109953924
               +xp*(7.6979330841-xp*(40.844896412+xp*(38.282141999
               -xp*(90.529504717+xp*(109.93053034-xp*(168.29068816
               +xp*(216.74542662-xp*(254.04407166+xp*(301.23376255
               -xp*(299.83692304+xp*(290.35481016-xp*(262.9383083
               +xp*(184.61968604-xp*(159.14627416+xp*(69.52062555
               -xp*(58.698294202+xp*(11.715653334
               -9.8564365005*xp)))))))))))))))))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.02:
        ydelta = ( u*u*(0.4618802153517-u*(1.3333333333333-u*(2.6577265103997
                   -4.6812470639856*u))) )
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.06224953019339+up*(0.1328158690775-up*(0.236741722263
                   +up*(0.6589627718965-up*(0.5420212226156+up*(2.036463256552
                   -up*(0.97288478567+up*(5.846171066704-up*(0.4786858467243
                   +up*(16.52467895771+up*(5.177873225504-up*(43.26855122074
                   +up*(23.12266235959-up*(97.49162419575+up*(52.38175330609
                   -up*(176.313696784+up*(68.31348886279-up*(238.6100261469
                   +up*(41.13149813131-up*(222.4411069882-up*(10.56142327328
                   +up*(125.8054728166-up*(30.66189892098+up*(32.28090591464
                   -13.18049019718*up))))))))))))))))))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndlorentz_lux( x, sintheta ):
    if x < 0.02:
        y0 = ( 1.0-x*(1.0-x*(1.0666666666667-x*(0.98765432098765
               -x*(0.79012345679012-0.55308641975309*x)))) )
    else:
        if x > 1e3:
            return bc2025_y_scndlorentz_lux(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.5336441259-xp*(0.8429114501-xp*(0.1770013802+xp*(0.6797417272
               -xp*(0.818932607+xp*(0.7066833263-xp*(2.153895064
               +xp*(0.942873933-xp*(5.438402926+xp*(2.034470992
               -xp*(12.91149187+xp*(5.399270166-xp*(26.43349543
               +xp*(11.99710274-xp*(43.38620265+xp*(19.31504654
               -xp*(54.09291652+xp*(21.30361545-xp*(48.71558791
               +xp*(15.19814842-xp*(29.65815201+xp*(6.299367185
               -xp*(10.86478452+xp*(1.14907036
               -1.800708025*xp))))))))))))))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.02:
        ydelta = ( u*u*(0.53333333333333-u*(1.9753086419753-u*(5.1358024691358
                   -11.891358024691*u))) )
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.05157982383+up*(0.08702046572-up*(0.199353768
                   +up*(0.2899285322-up*(0.6378148804+up*(0.5502529572
                   -up*(1.956981119+up*(0.9631382051-up*(5.54608499
                   +up*(2.04851528-up*(14.45528159+up*(4.719780698
                   -up*(32.73916116+up*(8.241956394-up*(59.63989821
                   +up*(7.43970856-up*(81.0118243-up*(2.53170678+up*(75.52806893
                   -up*(14.4309282+up*(42.64462669-up*(14.48078074
                   +up*(10.92280777-5.137685796*up)))))))))))))))))))))) )
    return y0 + sintheta*s*ydelta

def bc2025_y_scndfresnel_lux( x, sintheta ):
    if x < 0.02:
        y0 = ( 1.0-x*(1.0-x*(0.88-x*(0.63915343915344-x*(0.39352481733434
               -0.2100936347603*x)))) )
    else:
        if x > 1e3:
            return bc2025_y_scndfresnel_lux(1e3,sintheta)*(x*1e-3)**-0.5
        xs = x**0.5
        xp = (xs-1.0)/(xs+1.0)
        y0 = ( 0.4932694837076-xp*(0.9650580607045-xp*(0.2391707300191
               +xp*(1.231775501511-xp*(0.7162749186493+xp*(2.397392257122
               -xp*(1.286159487187+xp*(6.190338565047-xp*(2.15799495722
               +xp*(21.93947896347-xp*(11.66646771202+xp*(103.9329908487
               -xp*(110.3774765187+xp*(526.4911824684-xp*(699.0096620504
               +xp*(2257.913301253-xp*(2982.947865414+xp*(7410.986462373
               -xp*(9068.355396232+xp*(18053.43867394-xp*(20188.12192804
               +xp*(32202.67098807-xp*(33154.22980087+xp*(41377.0976758
               -xp*(39805.34287439+xp*(37198.46755365-xp*(33994.95728469
               +xp*(22166.48507268-xp*(19545.17021751+xp*(7852.794063735
               -xp*(6769.65264411+xp*(1249.922350984
               -1064.555223624*xp))))))))))))))))))))))))))))))) )
    s = sintheta**0.5
    u = x*s
    if u < 0.02:
        ydelta = ( u*u*(0.44-u*(1.2783068783069-u*(2.5579113126732
                   -4.5170131473465*u))) )
    else:
        us = u**0.5
        up = (us-1.0)/(us+1.0)
        ydelta = ( 0.05839675969497+up*(0.1215403942474-up*(0.2327031821943
                   +up*(0.6169197748584-up*(0.5576924427279+up*(1.966471723613
                   -up*(0.9739495091226+up*(5.856571787922-up*(0.3468732618105
                   +up*(19.93824999639+up*(5.12029535262-up*(85.66077650643
                   +up*(6.233382554383-up*(410.7966508641-up*(135.2115982125
                   +up*(1733.358492423-up*(1061.000115469+up*(5627.101189681
                   -up*(4404.594142741+up*(13334.67031813-up*(12107.00455643
                   +up*(22313.1140298-up*(23062.69191267+up*(25123.73631196
                   -up*(30242.49736349+up*(17135.34812358-up*(26106.24295471
                   +up*(4932.436511715-up*(13365.12956974-up*(1204.66538604
                   +up*(3074.520821506
                   -921.6011306758*up)))))))))))))))))))))))))))))) )
    return y0 + sintheta*s*ydelta


################################################################################
################################################################################
###                       Test code for BC2025 Recipes                       ###
###           Test function to call: bc2015_test_implementation()            ###
################################################################################
################################################################################

def bc2015_test_implementation():
    def t(x,sinth,refval):
        val = bc2025_y_primary(x,sinth)
        val_lux = bc2025_y_primary_lux(x,sinth)
        if not ( abs(val-refval) <= 0.001*min(refval,1.0-refval) ):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_primary(%g,%g)"%(x,sinth)
            )
        if not (abs(val_lux-refval) <= 1e-06*min(refval,1.0-refval)):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_primary_lux(%g,%g)"%(x,sinth)
            )
    print("Testing bc2025_y_primary + bc2025_y_primary_lux")
    t(1e-20,0,1)
    t(1e-20,0.37,1)
    t(1e-20,0.7071,1)
    t(1e-20,0.93,1)
    t(1e-20,1,1)
    t(1e-13,0,0.999999999999905742)
    t(1e-13,0.37,0.999999999999905742)
    t(1e-13,0.7071,0.999999999999905742)
    t(1e-13,0.93,0.999999999999905742)
    t(1e-13,1,0.999999999999905742)
    t(1e-12,0,0.999999999999057088)
    t(1e-12,0.37,0.999999999999057088)
    t(1e-12,0.7071,0.999999999999057088)
    t(1e-12,0.93,0.999999999999057088)
    t(1e-12,1,0.999999999999057088)
    t(0.0001,0,0.999905722489449977)
    t(0.0001,0.37,0.999905722830989552)
    t(0.0001,0.7071,0.999905724213736913)
    t(0.0001,0.93,0.999905725910026466)
    t(0.0001,1,0.99990572659042809)
    t(0.001,0,0.999057962697086133)
    t(0.001,0.37,0.999057996797014347)
    t(0.001,0.7071,0.999058134748896043)
    t(0.001,0.93,0.99905830389750816)
    t(0.001,1,0.999058371729258488)
    t(0.009,0,0.991580310627700912)
    t(0.009,0.37,0.991583034240936856)
    t(0.009,0.7071,0.991593979472062736)
    t(0.009,0.93,0.991607341081938376)
    t(0.009,1,0.991612688397355946)
    t(0.01,0,0.990652882165304338)
    t(0.01,0.37,0.990656238776665754)
    t(0.01,0.7071,0.990669716639168807)
    t(0.01,0.93,0.990686161056473114)
    t(0.01,1,0.99069274044635991)
    t(0.011,0,0.989727059403622267)
    t(0.011,0.37,0.989731113812797214)
    t(0.011,0.7071,0.989747380102478536)
    t(0.011,0.93,0.989767215916285248)
    t(0.011,1,0.989775150196034903)
    t(0.09,0,0.921378643745266457)
    t(0.09,0.37,0.921615887415132673)
    t(0.09,0.7071,0.922510563580389631)
    t(0.09,0.93,0.923558752275423278)
    t(0.09,1,0.923970372765745229)
    t(0.1,0,0.913359883597570255)
    t(0.1,0.37,0.913647965770169601)
    t(0.1,0.7071,0.914726352615906402)
    t(0.1,0.93,0.915983847452636613)
    t(0.1,1,0.916476606013764128)
    t(0.11,0,0.905473627109827595)
    t(0.11,0.37,0.905816514756760061)
    t(0.11,0.7071,0.907090710502909459)
    t(0.11,0.93,0.908569675300849533)
    t(0.11,1,0.909148001400050698)
    t(0.5,0,0.677397998871731022)
    t(0.5,0.37,0.681375531144782887)
    t(0.5,0.7071,0.693094594967365474)
    t(0.5,0.93,0.70493150458645526)
    t(0.5,1,0.709285545104949011)
    t(1.5,0,0.427059012343876054)
    t(1.5,0.37,0.438829477369566623)
    t(1.5,0.7071,0.463370141438253225)
    t(1.5,0.93,0.484182069478211519)
    t(1.5,1,0.491318844971881885)
    t(4,0,0.256478305440050736)
    t(4,0.37,0.271450489435057285)
    t(4,0.7071,0.294058279041176651)
    t(4,0.93,0.311164652224688087)
    t(4,1,0.316803783227092128)
    t(10,0,0.160692615730259891)
    t(10,0.37,0.172334879934710278)
    t(10,0.7071,0.187275015600959244)
    t(10,0.93,0.19822718194603256)
    t(10,1,0.201806603479064706)
    t(30,0,0.0927496567337003086)
    t(30,0.37,0.0995863832091555823)
    t(30,0.7071,0.108079350860056767)
    t(30,0.93,0.114326427593817989)
    t(30,1,0.116371315352427424)
    t(999,0,0.0160653610398071058)
    t(999,0.37,0.0172401058436648311)
    t(999,0.7071,0.0187047403164292345)
    t(999,0.93,0.0197827741536802069)
    t(999,1,0.0201357305432466258)
    t(1000,0,0.0160573261407892312)
    t(1000,0.37,0.0172314830286544526)
    t(1000,0.7071,0.0186953847519196886)
    t(1000,0.93,0.0197728792897164975)
    t(1000,1,0.0201256591124670571)
    t(1000.1,0,0.0160565233346921486)
    t(1000.1,0.37,0.0172306215191156964)
    t(1000.1,0.7071,0.0186944500527839452)
    t(1000.1,0.93,0.0197718907198941307)
    t(1000.1,1,0.020124652904976368)
    t(10000,0,0.00507777237370555211)
    t(10000,0.37,0.00544907338330845401)
    t(10000,0.7071,0.00591199975492481909)
    t(10000,0.93,0.00625273344550764977)
    t(10000,1,0.00636429222075187481)
    t(1000000000000,0,5.07777237370555256e-07)
    t(1000000000000,0.37,5.44907338330845463e-07)
    t(1000000000000,0.7071,5.91199975492481964e-07)
    t(1000000000000,0.93,6.2527334455076501e-07)
    t(1000000000000,1,6.36429222075187487e-07)
    t(1e+99,0,1.60573261407892309e-50)
    t(1e+99,0.37,1.72314830286544515e-50)
    t(1e+99,0.7071,1.86953847519196873e-50)
    t(1e+99,0.93,1.97728792897164961e-50)
    t(1e+99,1,2.01256591124670573e-50)
    t(1e+200,0,5.0777723737055523e-101)
    t(1e+200,0.37,5.44907338330845441e-101)
    t(1e+200,0.7071,5.91199975492481873e-101)
    t(1e+200,0.93,6.25273344550764931e-101)
    t(1e+200,1,6.36429222075187476e-101)
    def t(x,sinth,refval):
        val = bc2025_y_scndgauss(x,sinth)
        val_lux = bc2025_y_scndgauss_lux(x,sinth)
        if not ( abs(val-refval) <= 0.001*min(refval,1.0-refval) ):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndgauss(%g,%g)"%(x,sinth)
            )
        if not (abs(val_lux-refval) <= 1e-06*min(refval,1.0-refval)):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndgauss_lux(%g,%g)"%(x,sinth)
            )
    print("Testing bc2025_y_scndgauss + bc2025_y_scndgauss_lux")
    t(1e-20,0,1)
    t(1e-20,0.37,1)
    t(1e-20,0.7071,1)
    t(1e-20,0.93,1)
    t(1e-20,1,1)
    t(1e-13,0,0.999999999999893974)
    t(1e-13,0.37,0.999999999999893974)
    t(1e-13,0.7071,0.999999999999893974)
    t(1e-13,0.93,0.999999999999893974)
    t(1e-13,1,0.999999999999893974)
    t(1e-12,0,0.999999999998939293)
    t(1e-12,0.37,0.999999999998939293)
    t(1e-12,0.7071,0.999999999998939293)
    t(1e-12,0.93,0.999999999998939293)
    t(1e-12,1,0.999999999998939293)
    t(0.0001,0,0.999893943219759662)
    t(0.0001,0.37,0.999893943604313717)
    t(0.0001,0.7071,0.999893945161208886)
    t(0.0001,0.93,0.999893947071134992)
    t(0.0001,1,0.999893947837228736)
    t(0.001,0,0.998940262922392908)
    t(0.001,0.37,0.998940301317097323)
    t(0.001,0.7071,0.998940456643843677)
    t(0.001,0.93,0.998940647096726808)
    t(0.001,1,0.998940723471927972)
    t(0.009,0,0.990528399718734187)
    t(0.009,0.37,0.990531466451105014)
    t(0.009,0.7071,0.99054379074675869)
    t(0.009,0.93,0.990558836030893675)
    t(0.009,1,0.990564857181265301)
    t(0.01,0,0.98948511172574416)
    t(0.01,0.37,0.9894888912145966)
    t(0.01,0.7071,0.989504067325894687)
    t(0.01,0.93,0.989522583996211957)
    t(0.01,1,0.989529992530914226)
    t(0.011,0,0.98844363174074501)
    t(0.011,0.37,0.988448196954850977)
    t(0.011,0.7071,0.988466512940368802)
    t(0.011,0.93,0.988488848519800345)
    t(0.011,1,0.988497782751834531)
    t(0.09,0,0.911562637444368273)
    t(0.09,0.37,0.91182984491342689)
    t(0.09,0.7071,0.912837666638713241)
    t(0.09,0.93,0.914018527518092538)
    t(0.09,1,0.914482268329535386)
    t(0.1,0,0.902543729477368939)
    t(0.1,0.37,0.902868207385230104)
    t(0.1,0.7071,0.904083032834019806)
    t(0.1,0.93,0.90549977608786314)
    t(0.1,1,0.906054964136642105)
    t(0.11,0,0.893674079978205804)
    t(0.11,0.37,0.894060300442503064)
    t(0.11,0.7071,0.895495779046981633)
    t(0.11,0.93,0.897162136668675281)
    t(0.11,1,0.897813774121218655)
    t(0.5,0,0.637345276720855503)
    t(0.5,0.37,0.641830710434428853)
    t(0.5,0.7071,0.655054692256161419)
    t(0.5,0.93,0.668416681710815808)
    t(0.5,1,0.673332496976859263)
    t(1.5,0,0.357597444689184474)
    t(1.5,0.37,0.370896435653487344)
    t(1.5,0.7071,0.39864416210881054)
    t(1.5,0.93,0.422176335657189539)
    t(1.5,1,0.430245061090626379)
    t(4,0,0.17297395239130367)
    t(4,0.37,0.189879012656458984)
    t(4,0.7071,0.215258501298703303)
    t(4,0.93,0.234348559295702613)
    t(4,1,0.240621677545467538)
    t(10,0,0.0807180267555285547)
    t(10,0.37,0.0935745735759661579)
    t(10,0.7071,0.109430399854542268)
    t(10,0.93,0.120737870379589413)
    t(10,1,0.12438630443554409)
    t(30,0,0.0308030026998234036)
    t(30,0.37,0.0374331506022029178)
    t(30,0.7071,0.0446630365746027921)
    t(30,0.93,0.0496682757865696753)
    t(30,1,0.0512666946970163212)
    t(999,0,0.00122143170251923856)
    t(999,0.37,0.00157928392333777571)
    t(999,0.7071,0.00192676609247600461)
    t(999,0.93,0.00216076771498466182)
    t(999,1,0.00223476218498307828)
    t(1000,0,0.00122028414965030048)
    t(1000,0.37,0.00157781375102613859)
    t(1000,0.7071,0.00192497830984177045)
    t(1000,0.93,0.00215876529765583443)
    t(1000,1,0.00223269181037356315)
    t(1000.1,0,0.00122017030814190763)
    t(1000.1,0.37,0.00157766655522962587)
    t(1000.1,0.7071,0.00192479872672215134)
    t(1000.1,0.93,0.00215856390431820762)
    t(1000.1,1,0.00223248352035886272)
    t(10000,0,0.000142383928135902927)
    t(10000,0.37,0.00018410082586283293)
    t(10000,0.7071,0.00022460832045571348)
    t(10000,0.93,0.000251886811028229865)
    t(10000,1,0.000260512627627712404)
    t(1000000000000,0,4.8917130164293988e-12)
    t(1000000000000,0.37,6.32493019401069932e-12)
    t(1000000000000,0.7071,7.71659736570022946e-12)
    t(1000000000000,0.93,8.65377158999020815e-12)
    t(1000000000000,1,8.95011837497809759e-12)
    t(1e+99,0,3.29959753303634066e-93)
    t(1e+99,0.37,4.26634268909302845e-93)
    t(1e+99,0.7071,5.2050612016247022e-93)
    t(1e+99,0.93,5.83721148274434557e-93)
    t(1e+99,1,6.03710569513684424e-93)
    t(1e+200,0,1.92957191898721976e-187)
    t(1e+200,0.37,2.49491490014387209e-187)
    t(1e+200,0.7071,3.04386817807524513e-187)
    t(1e+200,0.93,3.4135433941631538e-187)
    t(1e+200,1,3.53043954744815707e-187)
    def t(x,sinth,refval):
        val = bc2025_y_scndlorentz(x,sinth)
        val_lux = bc2025_y_scndlorentz_lux(x,sinth)
        if not ( abs(val-refval) <= 0.001*min(refval,1.0-refval) ):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndlorentz(%g,%g)"%(x,sinth)
            )
        if not (abs(val_lux-refval) <= 1e-06*min(refval,1.0-refval)):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndlorentz_lux(%g,%g)"%(x,sinth)
            )
    print("Testing bc2025_y_scndlorentz + bc2025_y_scndlorentz_lux")
    t(1e-20,0,1)
    t(1e-20,0.37,1)
    t(1e-20,0.7071,1)
    t(1e-20,0.93,1)
    t(1e-20,1,1)
    t(1e-13,0,0.999999999999899969)
    t(1e-13,0.37,0.999999999999899969)
    t(1e-13,0.7071,0.999999999999899969)
    t(1e-13,0.93,0.999999999999899969)
    t(1e-13,1,0.999999999999899969)
    t(1e-12,0,0.999999999999000022)
    t(1e-12,0.37,0.999999999999000022)
    t(1e-12,0.7071,0.999999999999000022)
    t(1e-12,0.93,0.999999999999000022)
    t(1e-12,1,0.999999999999000022)
    t(0.0001,0,0.999900010665679129)
    t(0.0001,0.37,0.999900011109701836)
    t(0.0001,0.7071,0.999900012907317559)
    t(0.0001,0.93,0.999900015112513807)
    t(0.0001,1,0.999900015997037594)
    t(0.001,0,0.999001065679801958)
    t(0.001,0.37,0.999001109992181391)
    t(0.001,0.7071,0.999001289216636779)
    t(0.001,0.93,0.999001508937245819)
    t(0.001,1,0.999001597042950551)
    t(0.009,0,0.9910856851515224)
    t(0.009,0.37,0.991089210630832884)
    t(0.009,0.7071,0.991103348821331553)
    t(0.009,0.93,0.99112058472810427)
    t(0.009,1,0.991127478159255615)
    t(0.01,0,0.99010568685861311)
    t(0.01,0.37,0.990110029591393381)
    t(0.01,0.7071,0.990127426844987224)
    t(0.01,0.93,0.990148621204925639)
    t(0.01,1,0.990157095078302407)
    t(0.011,0,0.989127763578492414)
    t(0.011,0.37,0.989133006571792373)
    t(0.011,0.7071,0.989153988224505398)
    t(0.011,0.93,0.989179531663385569)
    t(0.011,1,0.989189741100344522)
    t(0.09,0,0.917968747806152341)
    t(0.09,0.37,0.918264757046562075)
    t(0.09,0.7071,0.91936110921278158)
    t(0.09,0.93,0.920631113580382632)
    t(0.09,1,0.92112729294202611)
    t(0.1,0,0.9097528189826527)
    t(0.1,0.37,0.910110749489652537)
    t(0.1,0.7071,0.91142447519078873)
    t(0.1,0.93,0.912937647317605849)
    t(0.1,1,0.913527312148028403)
    t(0.11,0,0.901699446207167576)
    t(0.11,0.37,0.90212370842963574)
    t(0.11,0.7071,0.903667060105980635)
    t(0.11,0.93,0.905434839585329443)
    t(0.11,1,0.906121994198515912)
    t(0.5,0,0.679484857014460153)
    t(0.5,0.37,0.683835026258809542)
    t(0.5,0.7071,0.695952597070977896)
    t(0.5,0.93,0.707838551395702509)
    t(0.5,1,0.712159062730127967)
    t(1.5,0,0.450909553995101353)
    t(1.5,0.37,0.46204677668140548)
    t(1.5,0.7071,0.484151009069781701)
    t(1.5,0.93,0.502678312036372255)
    t(1.5,1,0.509016994374947407)
    t(4,0,0.287152109145697998)
    t(4,0.37,0.300558728640546835)
    t(4,0.7071,0.321257651180918202)
    t(4,0.93,0.337268045522034154)
    t(4,1,0.342597462329693514)
    t(10,0,0.183933260109467284)
    t(10,0.37,0.195084924510890434)
    t(10,0.7071,0.210345782278526683)
    t(10,0.93,0.221803740614884309)
    t(10,1,0.225580067220738728)
    t(30,0,0.106766732862608862)
    t(30,0.37,0.114087479074691439)
    t(30,0.7071,0.123518815342400348)
    t(30,0.93,0.130506961130937377)
    t(30,1,0.132800000000000001)
    t(999,0,0.0185489882266850793)
    t(999,0.37,0.0199022500866932808)
    t(999,0.7071,0.0215914499946390122)
    t(999,0.93,0.0228350617321228556)
    t(999,1,0.0232422609737816636)
    t(1000,0,0.0185397128633782056)
    t(1000,0.37,0.0198923006742199558)
    t(1000,0.7071,0.0215806574956853257)
    t(1000,0.93,0.0228236482946756088)
    t(1000,1,0.0232306441938155799)
    t(1000.1,0,0.0185387859472531669)
    t(1000.1,0.37,0.0198913061337761578)
    t(1000.1,0.7071,0.0215795785437312634)
    t(1000.1,0.93,0.0228225071978424253)
    t(1000.1,1,0.0232294827487135452)
    t(10000,0,0.00586277198137972414)
    t(10000,0.37,0.00629049780314381614)
    t(10000,0.7071,0.00682440310903509924)
    t(10000,0.93,0.00721747131257928064)
    t(10000,1,0.00734617471654232766)
    t(1000000000000,0,5.86277198137972435e-07)
    t(1000000000000,0.37,6.29049780314381553e-07)
    t(1000000000000,0.7071,6.82440310903509955e-07)
    t(1000000000000,0.93,7.2174713125792808e-07)
    t(1000000000000,1,7.34617471654232877e-07)
    t(1e+99,0,1.85397128633782046e-50)
    t(1e+99,0.37,1.98923006742199557e-50)
    t(1e+99,0.7071,2.15806574956853264e-50)
    t(1e+99,0.93,2.28236482946756082e-50)
    t(1e+99,1,2.32306441938155811e-50)
    t(1e+200,0,5.86277198137972341e-101)
    t(1e+200,0.37,6.29049780314381608e-101)
    t(1e+200,0.7071,6.8244031090350985e-101)
    t(1e+200,0.93,7.21747131257928036e-101)
    t(1e+200,1,7.34617471654232763e-101)
    def t(x,sinth,refval):
        val = bc2025_y_scndfresnel(x,sinth)
        val_lux = bc2025_y_scndfresnel_lux(x,sinth)
        if not ( abs(val-refval) <= 0.001*min(refval,1.0-refval) ):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndfresnel(%g,%g)"%(x,sinth)
            )
        if not (abs(val_lux-refval) <= 1e-06*min(refval,1.0-refval)):
            raise RuntimeError(
                "bc2015_test_implementation: "
                "Failure in bc2025_y_scndfresnel_lux(%g,%g)"%(x,sinth)
            )
    print("Testing bc2025_y_scndfresnel + bc2025_y_scndfresnel_lux")
    t(1e-20,0,1)
    t(1e-20,0.37,1)
    t(1e-20,0.7071,1)
    t(1e-20,0.93,1)
    t(1e-20,1,1)
    t(1e-13,0,0.999999999999899969)
    t(1e-13,0.37,0.999999999999899969)
    t(1e-13,0.7071,0.999999999999899969)
    t(1e-13,0.93,0.999999999999899969)
    t(1e-13,1,0.999999999999899969)
    t(1e-12,0,0.999999999999000022)
    t(1e-12,0.37,0.999999999999000022)
    t(1e-12,0.7071,0.999999999999000022)
    t(1e-12,0.93,0.999999999999000022)
    t(1e-12,1,0.999999999999000022)
    t(0.0001,0,0.999900008799360918)
    t(0.0001,0.37,0.999900009165697434)
    t(0.0001,0.7071,0.999900010648836823)
    t(0.0001,0.93,0.999900012468281973)
    t(0.0001,1,0.99990001319808286)
    t(0.001,0,0.999000879361239824)
    t(0.001,0.37,0.999000915936696932)
    t(0.001,0.7071,0.999001063902838493)
    t(0.001,0.93,0.999001245329921517)
    t(0.001,1,0.999001318085486423)
    t(0.009,0,0.991070816626705819)
    t(0.009,0.37,0.991073737786429154)
    t(0.009,0.7071,0.991085476503148044)
    t(0.009,0.93,0.99109980646752649)
    t(0.009,1,0.991105541260750567)
    t(0.01,0,0.990087364760898203)
    t(0.01,0.37,0.990090964803397422)
    t(0.01,0.7071,0.990105419594910052)
    t(0.01,0.93,0.990123055546527797)
    t(0.01,1,0.990130111588998552)
    t(0.011,0,0.989105635014708051)
    t(0.011,0.37,0.989109983428291484)
    t(0.011,0.7071,0.989127428567477374)
    t(0.011,0.93,0.989148701360755611)
    t(0.011,1,0.989157210324545733)
    t(0.09,0,0.916686686396509076)
    t(0.09,0.37,0.916940982241070679)
    t(0.09,0.7071,0.917899652712336533)
    t(0.09,0.93,0.919022575437036138)
    t(0.09,1,0.9194634997882567)
    t(0.1,0,0.908198193066665715)
    t(0.1,0.37,0.908506958401812503)
    t(0.1,0.7071,0.909662351988239859)
    t(0.1,0.93,0.911009322804470889)
    t(0.1,1,0.911537084737879644)
    t(0.11,0,0.899851686707168641)
    t(0.11,0.37,0.900219164896514989)
    t(0.11,0.7071,0.901584198877591336)
    t(0.11,0.93,0.90316818524855913)
    t(0.11,1,0.903787502974892076)
    t(0.5,0,0.659409131196108778)
    t(0.5,0.37,0.663659802995088977)
    t(0.5,0.7071,0.676160714686383946)
    t(0.5,0.93,0.688772024068108335)
    t(0.5,1,0.69340829954302019)
    t(1.5,0,0.399391537851936262)
    t(1.5,0.37,0.411881935845156089)
    t(1.5,0.7071,0.437771759058127041)
    t(1.5,0.93,0.459644997052124471)
    t(1.5,1,0.467132755649424358)
    t(4,0,0.228676356271608677)
    t(4,0.37,0.244302243726306212)
    t(4,0.7071,0.26752883192663951)
    t(4,0.93,0.284943660965013057)
    t(4,1,0.290661423460214396)
    t(10,0,0.13889515089169982)
    t(10,0.37,0.150636185020350977)
    t(10,0.7071,0.165214272401134205)
    t(10,0.93,0.175733804134711902)
    t(10,1,0.179149979699797152)
    t(30,0,0.0791555029478179517)
    t(30,0.37,0.085571907221417845)
    t(30,0.7071,0.093235749158265338)
    t(30,0.93,0.0988114821782814789)
    t(30,1,0.100629854949566708)
    t(999,0,0.0136388653535980068)
    t(999,0.37,0.0146400998180710069)
    t(999,0.7071,0.0158858871922350139)
    t(999,0.93,0.016802473622760522)
    t(999,1,0.017102530942043951)
    t(1000,0,0.0136320418730609214)
    t(1000,0.37,0.0146327712142333838)
    t(1000,0.7071,0.0158779327680368988)
    t(1000,0.93,0.0167940591461938557)
    t(1000,1,0.0170939659039612904)
    t(1000.1,0,0.013631360322083166)
    t(1000.1,0.37,0.0146320396305409921)
    t(1000.1,0.7071,0.0158771389309357858)
    t(1000.1,0.93,0.0167932195062090207)
    t(1000.1,1,0.0170931112697631227)
    t(10000,0,0.00431083014776604666)
    t(10000,0.37,0.00462728855171251618)
    t(10000,0.7071,0.00502104320820185614)
    t(10000,0.93,0.00531074780615552796)
    t(10000,1,0.00540558665017767687)
    t(1000000000000,0,4.3108301477660464e-07)
    t(1000000000000,0.37,4.6272885517125163e-07)
    t(1000000000000,0.7071,5.02104320820185633e-07)
    t(1000000000000,0.93,5.31074780615552798e-07)
    t(1000000000000,1,5.40558665017767726e-07)
    t(1e+99,0,1.36320418730609202e-50)
    t(1e+99,0.37,1.46327712142333832e-50)
    t(1e+99,0.7071,1.58779327680368993e-50)
    t(1e+99,0.93,1.67940591461938551e-50)
    t(1e+99,1,1.70939659039612907e-50)
    t(1e+200,0,4.31083014776604605e-101)
    t(1e+200,0.37,4.62728855171251623e-101)
    t(1e+200,0.7071,5.02104320820185612e-101)
    t(1e+200,0.93,5.31074780615552798e-101)
    t(1e+200,1,5.40558665017767687e-101)
    print("All tests completed")

################################################################################
################################################################################
###               Hook for executing file as test application                ###
################################################################################
################################################################################

if __name__== "__main__":
    bc2015_test_implementation()
